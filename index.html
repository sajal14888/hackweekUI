<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Compass</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background-color: #F5F7FA;
            margin: 0;
            padding: 20px;
            color: #2C3E50;
            line-height: 1.6;
        }

        .post-form-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        h2 {
            font-size: 24px;
            font-weight: 500;
            margin-bottom: 24px;
            color: #2C3E50;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #2C3E50;
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            font-size: 14px;
            border: 1px solid #E0E0E0;
            border-radius: 4px;
            background-color: #FFFFFF;
            box-sizing: border-box;
            color: #2C3E50;
            margin-bottom: 16px;
        }

        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007CB2%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 8px;
            padding-right: 30px;
        }

        .search-button {
            background-color: #3B82F6;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
        }

        .search-summary {
            border-left: 4px solid #3B82F6;
            padding: 8px 12px;
            margin: 20px 0;
            font-size: 14px;
            color: #2C3E50;
            background-color: #F8FAFC;
        }

        .result-item {
            padding: 20px;
            border: 1px solid #E5E7EB;
            border-radius: 8px;
            margin-bottom: 16px;
            background-color: #FFFFFF;
        }

        .result-section {
            font-size: 16px;
            font-weight: 500;
            color: #2C3E50;
            margin-bottom: 12px;
        }

        .editable-content {
            padding: 12px;
            border: 1px solid #E5E7EB;
            border-radius: 4px;
            margin: 12px 0;
            font-size: 14px;
            line-height: 1.6;
            min-height: 80px;
        }

        .result-type {
            font-size: 12px;
            color: #6B7280;
            margin: 8px 0;
        }

        .button-group {
            margin-top: 12px;
            display: flex;
            align-items: center;
        }

        .save-status {
            color: #10B981;
            margin-left: 12px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .save-status.visible {
            opacity: 1;
        }

        .comparison-view {
            display: none;
            margin-top: 16px;
            gap: 16px;
            border-top: 1px solid #E0E0E0;
            padding-top: 16px;
        }

        .comparison-view.visible {
            display: flex;
        }

        .comparison-column {
            flex: 1;
            padding: 16px;
            border-radius: 8px;
            background-color: #F8FAFC;
            border: 1px solid #E0E0E0;
        }

        .comparison-column h4 {
            margin: 0 0 12px 0;
            color: #2C3E50;
            font-size: 14px;
            font-weight: 600;
        }

        .comparison-content {
            font-size: 14px;
            line-height: 1.6;
            color: #2C3E50;
            white-space: pre-wrap;
        }

        .original-version {
            background-color: #FFF9C4;
        }

        .edited-version {
            background-color: #E8F5E9;
        }

        .compare-button {
            background-color: #3B82F6;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 14px;
            cursor: pointer;
            margin-right: 8px;
        }

        .compare-button:hover {
            background-color: #2563EB;
        }

        .save-button {
            background-color: #10B981;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 14px;
            cursor: pointer;
            margin-right: 8px;
        }

        .export-button {
            background-color: #6B7280;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
            font-size: 14px;
            cursor: pointer;
        }

        .search-term-highlight {
            background-color: #FFF9C4;
            padding: 2px 0;
        }

        [contenteditable="true"]:focus {
            outline: none;
            border-color: #3B82F6;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="post-form-container">
        <h2>Content Compass</h2>
        <div>
            <label>Select the Content Database*</label>
            <select class="form-control" id="postType">
                <option value="square-help" selected>Square Help</option>
                <option value="squarewise">Google Drive</option>
                <option value="high-spot">High Spot</option>
            </select>
        </div>

        <div>
            <label>Search Your Topic</label>
            <input type="text" class="form-control" id="searchTopic" placeholder="">
            <div class="button-group-top">
                <button class="search-button" id="searchButton">Search</button>
            </div>
        </div>

        <div id="searchResults" class="search-results"></div>
    </div>

    <script>
        const squareHelpContent = {
            articles: [
                {
                    title: "Who is this article for?",
                    content: "Sellers with Risk Manager permissions to view and edit alert, block, and rule settings. Set permissions in Square Dashboard.",
                    type: "section"
                },
                {
                    title: "About Risk Manager",
                    content: "Risk Manager is a tool that helps you catch and manage online payments that pose a potential fraud risk. Creating a rule in Risk Manager allows you to select what actions can be taken on an online payment if certain conditions within that rule are met. Rules can either decline a payment from a specific payment card, trigger a risk alert, or invoke 3D Secure (3DS). Rules can be set based on payment card conditions as well.\n\nRisk Manager's fraud monitoring is free to use for businesses that process payments with Square. Risk Manager is not available on transactions processed via Square Virtual Terminal or Afterpay.",
                    type: "section"
                },
                // ... [previous article content remains the same]
            ]
        };

        function compareContent(sectionTitle) {
            const safeTitleId = sectionTitle.replace(/[^a-zA-Z0-9]/g, '-');
            const comparisonView = document.getElementById(`comparison-${safeTitleId}`);
            const editedContent = document.getElementById(`edited-${safeTitleId}`);
            const contentDiv = document.querySelector(`[data-section="${sectionTitle}"]`);
            
            if (comparisonView && editedContent && contentDiv) {
                // Update edited version with current content
                editedContent.textContent = contentDiv.innerText;
                
                // Toggle comparison view
                if (comparisonView.classList.contains('visible')) {
                    comparisonView.classList.remove('visible');
                } else {
                    comparisonView.classList.add('visible');
                }
            }
        }

        function saveContent(sectionTitle) {
            const contentDiv = document.querySelector(`[data-section="${sectionTitle}"]`);
            if (contentDiv) {
                const articleIndex = squareHelpContent.articles.findIndex(a => a.title === sectionTitle);
                if (articleIndex !== -1) {
                    squareHelpContent.articles[articleIndex].content = contentDiv.innerText;
                    const saveStatus = document.getElementById(`save-status-${sectionTitle.replace(/[^a-zA-Z0-9]/g, '-')}`);
                    saveStatus.classList.add('visible');
                    setTimeout(() => {
                        saveStatus.classList.remove('visible');
                    }, 2000);
                }
            }
        }

        function exportContent(sectionTitle) {
            const contentDiv = document.querySelector(`[data-section="${sectionTitle}"]`);
            if (contentDiv) {
                const content = contentDiv.innerText;
                const blob = new Blob([content], { type: 'text/plain' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${sectionTitle.toLowerCase().replace(/\s+/g, '-')}.txt`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            }
        }

        function handleSearch() {
            const searchQuery = document.getElementById('searchTopic').value.trim();
            const resultsDiv = document.getElementById('searchResults');

            if (!searchQuery) {
                resultsDiv.innerHTML = '<div class="error-message">Please enter a search term</div>';
                return;
            }

            const searchTerms = searchQuery.toLowerCase().split(' ').filter(term => term.length > 0);
            const searchResults = [];

            squareHelpContent.articles.forEach(article => {
                const matches = searchTerms.every(term => 
                    article.content.toLowerCase().includes(term) ||
                    article.title.toLowerCase().includes(term)
                );

                if (matches) {
                    searchResults.push({
                        title: article.title,
                        content: article.content,
                        type: article.type
                    });
                }
            });

            if (searchResults.length > 0) {
                resultsDiv.innerHTML = `
                    <h3>Search Results from Square Risk Manager Guide</h3>
                    <div class="search-summary">Found ${searchResults.length} matching sections</div>
                    ${searchResults.map(result => {
                        let highlightedContent = result.content;
                        let highlightedTitle = result.title;
                        searchTerms.forEach(term => {
                            const regex = new RegExp(`(${term})`, 'gi');
                            highlightedContent = highlightedContent.replace(regex, '<span class="search-term-highlight">$1</span>');
                            highlightedTitle = highlightedTitle.replace(regex, '<span class="search-term-highlight">$1</span>');
                        });
                        
                        return `
                            <div class="result-item">
                                <div class="result-section">${highlightedTitle}</div>
                                <div class="editable-content" contenteditable="true" data-section="${result.title}">${highlightedContent}</div>
                                <div class="button-group">
                                    <button class="save-button" onclick="saveContent('${result.title}')">Save Changes</button>
                                    <button class="compare-button" onclick="compareContent('${result.title}')">Compare</button>
                                    <button class="export-button" onclick="exportContent('${result.title}')">Export to Text</button>
                                    <span class="save-status" id="save-status-${result.title.replace(/[^a-zA-Z0-9]/g, '-')}">Saved!</span>
                                </div>
                                <div class="comparison-view" id="comparison-${result.title.replace(/[^a-zA-Z0-9]/g, '-')}">
                                    <div class="comparison-column">
                                        <h4>Original Version</h4>
                                        <div class="comparison-content original-version">${result.content}</div>
                                    </div>
                                    <div class="comparison-column">
                                        <h4>Edited Version</h4>
                                        <div class="comparison-content edited-version" id="edited-${result.title.replace(/[^a-zA-Z0-9]/g, '-')}">${result.content}</div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                `;
            } else {
                resultsDiv.innerHTML = '<div class="no-results">No matching content found</div>';
            }
        }

        document.getElementById('searchButton').addEventListener('click', handleSearch);
        document.getElementById('searchTopic').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleSearch();
        });
    </script>
</body>
</html>